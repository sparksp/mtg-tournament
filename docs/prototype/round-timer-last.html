<!doctype html>
<html lang="en-GB">

<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title></title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <script src="https://use.fontawesome.com/1048edd5be.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/purecss@0.6.2/build/pure-min.css" integrity="sha384-UQiGfs9ICog+LwheBSRCt1o5cbyKIHbwjWscjemyBMT9YCUMZffs6UqUTd0hObXD"
        crossorigin="anonymous">
    <link rel="stylesheet" href="https://unpkg.com/purecss@0.6.2/build/grids-responsive-min.css" crossorigin="anonymous">
    <link rel="stylesheet" href="tournament.css">
</head>

<body>
    <!--[if lt IE 8]>
        <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
    <![endif]-->

    <div class="pure-g">
        <div class="pure-u-1 l-box">
            <h1>Draft Tournament</h1>

            <h2>Round 3</h2>
            <h3>Time Remaining</h3>

            <p class="countdown" id="countdown"></p>
            <p class="countdown-information" id="countdown-information"></p>
            <script>
                (function (countdownId, informationId, lateInformation, finalInformation, finalTime) {
                    "use strict";

                    const ONE_MINUTE = 60000;
                    const FIVE_MINUTES = 5 * ONE_MINUTE;
                    const OVER_FIVE_MINUTES = 5.1 * ONE_MINUTE;

                    var pad = function (digit) {
                        if (digit < 10) {
                            return "0" + digit;
                        }
                        return digit;
                    }

                    var formatTime = function (milliseconds) {
                        var seconds = parseInt(milliseconds / 1000, 10);
                        var minutes = parseInt(seconds / 60, 10);
                        seconds = seconds % 60;

                        return minutes + ":" + pad(seconds);
                    }

                    var now = function () {
                        return new Date();
                    }

                    var setText = function (elm, text) {
                        if (elm.innerText != text) {
                            elm.innerText = text;
                        }
                    }

                    var timer = null;
                    var stopTimer = function () {
                        if (timer != null) {
                            clearInterval(timer);
                        }
                        timer = null;
                    }

                    var updateTime = (function () {
                        var countdown = document.getElementById(countdownId);
                        var timeElm = document.createElement("span");
                        countdown.appendChild(timeElm);
                        var informationElm = document.getElementById(informationId);

                        var endTime = new Date(now().getTime() + OVER_FIVE_MINUTES);

                        return function () {
                            var timeRemaining = endTime - now();
                            var timeText = formatTime(timeRemaining);
                            var informationText = "";

                            if (timeRemaining < FIVE_MINUTES) {
                                timeElm.style = "color: red";
                                informationText = lateInformation;
                            }

                            if (timeRemaining <= 0) {
                                timeText = finalTime;
                                informationText = finalInformation;
                                stopTimer();
                            }

                            setText(timeElm, timeText);
                            setText(informationElm, informationText);
                        }
                    })();

                    timer = setInterval(updateTime, 100);
                    setTimeout(updateTime, 1); // async
                })("countdown", "countdown-information", "", "Take 5 additional turns", "TURNS");
            </script>

            <p>
                <a class="pure-button button-secondary" href="enter-score.html"><i class="fa fa-pencil-square-o" aria-hidden="true"></i> Enter Score</a>
                <a class="pure-button button-primary" href="tournament-scores.html"><i class="fa fa-check" aria-hidden="true"></i> Finish Tournament</a>
            </p>
        </div>
    </div>
</body>

</html>